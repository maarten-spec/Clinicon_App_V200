<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Clinicon - Perzentilen Berechnung</title>
  <style>
.percentile-app{
    display:grid;
    gap:24px;
  }
  .percentile-app .form-card{
    display:grid;
    gap:20px;
  }
  .percentile-app .form-top{
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .percentile-app .form-top h2{
    margin:0;
    font-size:1.5rem;
  }
  .percentile-app .form-top p{
    margin:0;
    color:var(--muted);
  }
  .percentile-app .form-layout{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
    gap:16px 20px;
    align-items:end;
  }
  .percentile-app .form-field{
    display:flex;
    flex-direction:column;
    gap:6px;
  }
  .percentile-app .form-field label{
    font-weight:600;
    font-size:.95rem;
  }
  .percentile-app .form-field input,
  .percentile-app .form-field select{
    padding:10px 12px;
    border:1px solid var(--line);
    border-radius:10px;
    font:inherit;
  }
  .percentile-app .form-submit{
    padding:12px 20px;
    border-radius:12px;
    border:none;
    background:var(--accent);
    color:#fff;
    font-weight:600;
    cursor:pointer;
    transition:.15s ease background;
  }
  .percentile-app .form-submit:hover{
    background:var(--accent-strong);
  }
  .percentile-app #result{
    margin:0;
    font-size:1.05rem;
    font-weight:600;
    color:var(--accent-strong);
  }
  .percentile-app .chart-card{
    display:grid;
    gap:16px;
  }
  .percentile-app .chart-card h2{
    margin:0;
    font-size:1.4rem;
  }
  .percentile-app .chart-card canvas{
    display:block;
    width:100%;
    height:360px;
    max-height:360px;
    background:#fff;
    border:1px solid var(--line);
    border-radius:12px;
    padding:12px;
  }
  .percentile-app .print-actions{
    display:flex;
    justify-content:flex-end;
  }
  .percentile-app .print-button{
    padding:10px 18px;
    border-radius:12px;
    border:1px solid var(--accent);
    background:#fff;
    color:var(--accent);
    font-weight:600;
    cursor:pointer;
    transition:.15s ease all;
  }
  .percentile-app .print-button:hover{
    background:var(--accent);
    color:#fff;
  }
      /* Unified navigation + header */
    .nav{
      width:100%;
      align-items:stretch;
      flex-direction:column;
      gap:10px;
      margin-top:8px;
    }
    .nav a{
      width:100%;
      border-radius:18px;
      padding:12px 16px;
      border:1px solid rgba(15,23,42,0.08);
      background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(246,249,255,0.96));
      box-shadow:0 10px 20px rgba(15,23,42,0.06);
      transition:transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .nav a:hover{
      transform:translateY(-1px);
      border-color:rgba(28,107,255,0.28);
      box-shadow:0 16px 30px rgba(28,107,255,0.18);
    }
    .nav a.active{
      background:linear-gradient(135deg, var(--accent), #458cff);
      color:#fff;
      border-color:transparent;
      box-shadow:0 18px 34px rgba(28,107,255,0.28);
    }
    .nav a span{font-weight:600; letter-spacing:.01em;}
    .nav a svg{
      width:28px;
      height:28px;
      padding:6px;
      border-radius:12px;
      background:rgba(28,107,255,0.12);
      color:#1f4b82;
      flex-shrink:0;
      box-shadow:inset 0 0 0 1px rgba(28,107,255,0.12);
    }
    .nav a.active svg{
      background:rgba(255,255,255,0.25);
      color:#fff;
      box-shadow:inset 0 0 0 1px rgba(255,255,255,0.35);
    }
    .nav-group{
      width:100%;
      display:flex;
      flex-direction:column;
      gap:8px;
      padding:4px 0 0;
    }
    .nav-group-title{
      padding-left:8px;
      font-size:0.72rem;
      text-transform:uppercase;
      letter-spacing:.16em;
      color:var(--muted);
    }
    .nav-sub{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin:0;
      padding-left:0;
    }
    .nav-sub a{
      border-radius:16px;
      padding:10px 14px;
    }
    .nav-sub a svg{
      width:24px;
      height:24px;
      padding:5px;
      border-radius:10px;
    }
    header{
      border-radius:24px;
      margin:16px 20px 0;
      width:calc(100% - 40px);
      border:1px solid var(--line);
      box-shadow:0 16px 32px rgba(15,23,42,0.1);
    }
    @media (max-width: 900px){
      header{
        margin:12px 14px 0;
        width:calc(100% - 28px);
      }
      .nav{flex-direction:column;}
      .nav-sub{flex-direction:column;}
    }

</style>
  <link rel="stylesheet" href="../assets/items/app-shell.css" />
</head>
<body data-app-page="perzentilen" data-app-title="Perzentilen Berechnung" data-app-subtitle="Statistische Auswertung">
  <div class="shell">
<aside class="side">
  <a class="brand" href="start.html">
    <img src="../assets/pics/gfo-logo.jpg" alt="GFO Logo" />
  </a>
  <nav class="nav">
    <a href="start.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9.5L12 3l9 6.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1V9.5z"/></svg>
      <span>Start</span>
    </a>
    <a href="klinikverbund.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="3" width="14" height="18" rx="2"/><path d="M9 3h6v4H9z"/></svg>
      <span>Klinikverbund</span>
    </a>
    <a href="benchmark.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19V5"/><path d="M4 19h16"/><path d="M7 14l3-3 4 4 5-6"/></svg>
      <span>Benchmark</span>
    </a>
    <a href="fachabteilungen.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 6h16M4 12h16M4 18h10"/></svg>
      <span>Fachabteilungen</span>
    </a>
    <a href="erfassung-da03.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="5" y="3" width="14" height="18" rx="2"/><path d="M9 3h6v4H9z"/></svg>
      <span>Erfassung DA03</span>
    </a>
    <a href="clinicon-assistent.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20v-2"/><path d="M12 4a4 4 0 0 1 4 4c0 2-2 3-2 4H10c0-1-2-2-2-4a4 4 0 0 1 4-4z"/></svg>
      <span>Clinicon Assistent</span>
    </a>
    <a href="clinicon-insights.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"/><path d="M12 7v10"/><path d="M7 12h10"/></svg>
      <span>Clinicon Insights</span>
    </a>
    <a href="stellenplan.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 6h16M4 12h10M4 18h7"/></svg>
      <span>Stellenplan</span>
    </a>
    <a href="stellenplan-gesamt.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
      <span>Stellenplan Gesamt</span>
    </a>
    <a href="stellenplan-insights.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"/><path d="M12 7v10"/><path d="M7 12h10"/></svg>
      <span>Stellenplan Insights</span>
    </a>
    <div class="nav-group">
      <div class="nav-group-title">Berechnungen</div>
      <div class="nav-sub">
        <a href="stellenplan-berechnung.html">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="3" width="16" height="18" rx="2"/><path d="M8 7h8"/><path d="M8 11h3"/><path d="M13 11h3"/><path d="M8 15h3"/><path d="M13 15h3"/></svg>
          <span>Stellenplan Berechnung</span>
        </a>
        <a href="perzentilen-berechnung.html">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19V5"/><path d="M4 19h16"/><path d="M7 15l3-3 3 3 4-5"/></svg>
          <span>Perzentilen Berechnung</span>
        </a>
      </div>
    </div>
    <div class="nav-group">
      <div class="nav-group-title">Dienstarten</div>
      <div class="nav-sub">
        <a href="stellenplan-dienstart-01.html">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/></svg>
          <span>DA01</span>
        </a>
        <a href="stellenplan-dienstart-02.html">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/></svg>
          <span>DA02</span>
        </a>
        <a href="stellenplan-dienstart-03.html">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/></svg>
          <span>DA03</span>
        </a>
      </div>
    </div>
    <a href="map-tool.html">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l-6 3V6l6-3 6 3 6-3v15l-6 3-6-3z"/><path d="M9 3v15"/><path d="M15 6v15"/></svg>
      <span>Map-Tool</span>
    </a>
  </nav>
  <div class="side-footer">app.clinicon &middot; GFO Standort</div>
</aside>
    <div>
      <header>
        <div class="topbar-left">
          <h1>Perzentilen Berechnung</h1>
          <p>Statistische Auswertung</p>
        </div>
        <div class="topbar-actions">
          <span class="timestamp-pill" data-app-timestamp></span>
        </div>
      </header>

      <main class="percentile-app">
<section class="card form-card">
          <div class="form-top">
            <h2>Eingaben</h2>
            <p>Berechnen Sie den WHO-Perzentilenwert fuer Kinder und Jugendliche.</p>
          </div>

          <div class="form-layout">
            <div class="form-field">
              <label for="age">Alter (Monate)</label>
              <input type="number" id="age" min="0" max="228" placeholder="z. B. 72 (6 Jahre)">
            </div>
            <div class="form-field">
              <label for="height">Groesse (cm)</label>
              <input type="number" id="height" min="30" max="220" placeholder="z. B. 120">
            </div>
            <div class="form-field">
              <label for="sex">Geschlecht</label>
              <select id="sex">
                <option value="m">Junge</option>
                <option value="w">Maedchen</option>
              </select>
            </div>
            <button type="button" class="form-submit" onclick="calcPercentile()">Berechnen</button>
          </div>

          <p id="result"></p>
        </section>

        <section class="card chart-card">
          <h2>Wachstumsdiagramm</h2>
          <canvas id="growthChart"></canvas>
          <div class="print-actions">
            <button type="button" class="print-button" onclick="handlePrint()">Drucken</button>
          </div>
        </section>
</main>
    </div>
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
</script>
<script>
    const whoBoys = {
      months:[0,6,12,24,36,48,60,72,84,96,108,120,132,144,156,168,180],
      P3:[46,65,73,85,95,102,108,114,120,125,130,135,140,145,150,160,168],
      P15:[49,67,75,87,97,104,110,116,122,127,132,137,142,147,153,165,173],
      P50:[50,69,77,89,99,106,112,118,124,130,135,140,145,150,157,170,178],
      P85:[52,71,79,91,101,108,114,120,126,132,137,142,147,153,160,174,181],
      P97:[54,73,81,93,103,110,116,122,128,134,139,144,149,155,162,176,183]
    };
    const whoGirls = {
      months:[0,6,12,24,36,48,60,72,84,96,108,120,132,144,156,168,180],
      P3:[45,63,71,83,93,99,105,110,115,120,125,130,135,140,146,158,165],
      P15:[48,65,73,85,95,101,107,112,117,122,127,132,137,142,148,160,167],
      P50:[49,67,75,87,97,103,109,114,119,124,129,134,139,144,150,162,169],
      P85:[51,69,77,89,99,105,111,116,121,126,131,136,141,146,152,164,171],
      P97:[53,71,79,91,101,107,113,118,123,128,133,138,143,148,154,166,173]
    };

    let chartInstance = null;

    function withChart(callback){
      const attempt = () => {
        const canvas = document.getElementById('growthChart');
        if(typeof window.Chart !== 'function' || !canvas){
          setTimeout(attempt, 40);
          return;
        }
        if(!chartInstance){
          canvas.height = 360;
          canvas.style.height = '360px';
          canvas.style.maxHeight = '360px';
          canvas.style.width = '100%';
          chartInstance = new Chart(canvas, {
            type:'line',
            data:{labels:[],datasets:[]},
            options:{
              responsive:true,
              maintainAspectRatio:false,
              scales:{
                y:{title:{display:true,text:'K\u00f6rpergr\u00f6\u00dfe (cm)'}},
                x:{title:{display:true,text:'Alter (Monate)'}}
              },
              plugins:{legend:{position:'bottom'}},
              elements:{line:{tension:0.25}}
            }
          });
        }
        callback(chartInstance);
      };
      attempt();
    }

    function calcPercentile(){
      const age = Number(document.getElementById('age').value);
      const height = Number(document.getElementById('height').value);
      const sex = document.getElementById('sex').value;
      if(!age && age !== 0 || !height){
        document.getElementById('result').textContent = 'Bitte alle Werte eingeben.';
        return;
      }
      const ref = sex === 'm' ? whoBoys : whoGirls;
      const nearest = ref.months.findIndex(v => v >= age);
      if(nearest <= 0){
        document.getElementById('result').textContent = 'Alter au\u00dferhalb des Referenzbereichs.';
        return;
      }
      const i = nearest - 1;
      const frac = (age - ref.months[i]) / (ref.months[i+1] - ref.months[i]);
      const interp = arr => arr[i] + (arr[i+1] - arr[i]) * frac;
      const percValues = {
        P3:interp(ref.P3),
        P15:interp(ref.P15),
        P50:interp(ref.P50),
        P85:interp(ref.P85),
        P97:interp(ref.P97)
      };

      let percentile = 50;
      if(height <= percValues.P3) percentile = 3;
      else if(height <= percValues.P15) percentile = 15;
      else if(height <= percValues.P50) percentile = 50;
      else if(height <= percValues.P85) percentile = 85;
      else if(height <= percValues.P97) percentile = 97;
      else percentile = 99;

      document.getElementById('result').innerHTML =
        `Groesse: <strong>${height} cm</strong> entspricht etwa der <strong>${percentile}. Perzentile</strong>.`;

      drawChart(ref, age, height);
    }

    function drawChart(ref, age, height){
      withChart(chart => {
        chart.data.labels = ref.months;
        chart.data.datasets = [
          {label:'P3',data:ref.P3,borderColor:'#bfdbfe',borderDash:[6,4],fill:false,pointRadius:0},
          {label:'P15',data:ref.P15,borderColor:'#93c5fd',borderDash:[6,4],fill:false,pointRadius:0},
          {label:'P50',data:ref.P50,borderColor:'#1f2937',fill:false,pointRadius:0},
          {label:'P85',data:ref.P85,borderColor:'#60a5fa',borderDash:[6,4],fill:false,pointRadius:0},
          {label:'P97',data:ref.P97,borderColor:'#1d4ed8',borderDash:[6,4],fill:false,pointRadius:0},
          {
            label:'Messwert',
            data:[{x:age,y:height}],
            borderColor:'#dc2626',
            pointBackgroundColor:'#dc2626',
            pointRadius:6,
            fill:false,
            showLine:false,
            parsing:false
          }
        ];
        chart.update('none');
      });
    }
    function handlePrint(){
      window.print();
    }
    withChart(()=>{});
  </script>
  <script>
  (() => {
    const stamp = document.querySelector('[data-app-timestamp]');
    const updateTimestamp = () => {
      if (!stamp) return;
      const now = new Date();
      const label = now.toLocaleString('de-DE', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
      });
      stamp.textContent = `Stand: ${label}`;
    };
    updateTimestamp();
    setInterval(updateTimestamp, 60000);
  })();
</script>
</body>
</html>



