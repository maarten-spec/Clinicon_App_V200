<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="refresh" content="0; url=pages/start.html">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Clinicon Suite - Weiterleitung</title>
  <script>
    (function(){
      const API_BASE = "";
      const FALLBACK_BASE = "https://clinicon-stellenplan.maarten-koomen.workers.dev";
      const normalizeTenant = (value) => String(value || "").toLowerCase().replace(/[^a-z0-9]/g, "");
      const fallbackTarget = "pages/start.html" + (window.location.search || "") + (window.location.hash || "");

      const redirectToTenant = async () => {
        try {
          const params = new URLSearchParams(window.location.search);
          const devTenant = params.get("devTenant");
          const buildTenantUrl = (base) =>
            devTenant
              ? `${base}/api/tenants?devTenant=${encodeURIComponent(devTenant)}`
              : `${base}/api/tenants`;
          let res = await fetch(buildTenantUrl(API_BASE), { headers: { Accept: "application/json" } });
          if (!res.ok) {
            res = await fetch(buildTenantUrl(FALLBACK_BASE), { headers: { Accept: "application/json" } });
          }
          if (!res.ok) throw new Error("tenant fetch failed");
          const data = await res.json();
          const tenants = Array.isArray(data.tenants) ? data.tenants : [];
          const storedTenant = Number.parseInt(sessionStorage.getItem("tenant_id"), 10);
          const activeTenant = Number.isFinite(storedTenant)
            ? tenants.find((t) => t.id === storedTenant)
            : (data.tenant || tenants[0]);
          const code = activeTenant ? (activeTenant.code || activeTenant.name) : "";
          const slug = normalizeTenant(code);
          if (!slug) throw new Error("no tenant slug");
          const target = `/${slug}/pages/start.html${window.location.search || ""}${window.location.hash || ""}`;
          window.location.replace(target);
        } catch (err) {
          window.location.replace(fallbackTarget);
        }
      };
      redirectToTenant();
    })();
  </script>
  <style>
    @import url("https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap");
    :root{
      --font-base:"Manrope","Segoe UI",sans-serif;
      --font-size-base:16px;
      --line-height-base:1.6;
      --text:#0f172a;
    }
    body{
      margin:0;
      font-family:var(--font-base);
      font-size:var(--font-size-base);
      line-height:var(--line-height-base);
      color:var(--text);
    }
  </style>
</head>
<body>
  <p>Weiterleitung zur Clinicon Suite Startseite ...</p>
</body>
</html>




